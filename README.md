# Анализатор управления ресурсами

Профессиональное настольное приложение для анализа файлов планов Microsoft Project с целью выявления дисбаланса рабочей нагрузки и предоставления рекомендаций по оптимизации.

## Возможности

- **Поддержка файлов MS Project**: Загрузка и парсинг XML-файлов Microsoft Project (.xml, .mspdi)
- **Интеллектуальный расчёт рабочей нагрузки**: Анализ распределения ресурсов на основе фактических сроков проекта и мощности ресурсов
- **Поиск персонала**: Фильтрация и поиск задач по именам и фамилиям ресурсов
- **Визуальный анализ**: Цветные индикаторы статуса для быстрого выявления проблем с ресурсами
  - 🔴 Красный: Перегружен (>100% мощности)
  - 🟢 Зелёный: Оптимально (70-100% мощности)
  - 🟡 Жёлтый: Недоиспользуется (<70% мощности)
- **Умные рекомендации**: Практические предложения по балансировке рабочей нагрузки
- **Варианты экспорта**: Скачивание анализа в формате CSV или PDF

## Как использовать

### 1. Подготовка файла MS Project

Если у вас есть файл .mpp, конвертируйте его в формат XML:
1. Откройте ваш проект в Microsoft Project
2. Перейдите в **Файл → Сохранить как**
3. Выберите **Формат XML (*.xml)** в качестве типа файла
4. Сохраните файл

### 2. Загрузка и анализ

1. Нажмите "Выберите файл" на боковой панели
2. Выберите ваш XML-файл MS Project
3. Нажмите "Анализировать файл" для анализа данных
4. Просмотрите панель анализа рабочей нагрузки

### 3. Фильтрация и поиск

- Используйте поле поиска для фильтрации ресурсов по имени или фамилии
- Выберите конкретные ресурсы с помощью выпадающего списка множественного выбора
- Разверните отдельные ресурсы для просмотра детальной разбивки задач

### 4. Просмотр рекомендаций

Система предоставляет приоритизированные рекомендации:
- **Высокий приоритет**: Ресурсы с нагрузкой более 120%
- **Средний приоритет**: Ресурсы с нагрузкой 100-120%
- **Низкий приоритет**: Предложения по оптимизации недоиспользуемых ресурсов

### 5. Экспорт результатов

Скачайте ваш анализ в виде:
- **CSV**: Для дальнейшего анализа в Excel или других инструментах
- **PDF**: Профессиональный отчёт для презентаций

## Расчёт рабочей нагрузки

Приложение рассчитывает процент рабочей нагрузки на основе:

- **Длительности проекта**: Автоматически определяется из дат начала/окончания задач
- **Мощности ресурса**: На основе MaxUnits и стандартной 40-часовой рабочей недели (5 дней × 8 часов)
- **Назначений задач**: Общее количество часов, выделенных каждому ресурсу

**Модель мощности**:
- Календарные дни конвертируются в рабочие дни с использованием соотношения 5/7 (5-дневная рабочая неделя)
- Каждый рабочий день предоставляет 8 часов рабочей мощности (соответствует P1D = 8 часов в MS Project)
- Мощность ресурса = Доступные рабочие часы × MaxUnits

**Формула**: `Нагрузка % = (Общее количество назначенных часов / Мощность) × 100`

**Примеры** (для MaxUnits = 1.0):
- 1 календарный день → 0.71 рабочих дней → 5.71 рабочих часов мощности
- 7 календарных дней → 5 рабочих дней → 40 рабочих часов мощности
- 28 календарных дней → 20 рабочих дней → 160 рабочих часов мощности

## Цветовая схема

В соответствии с руководством по дизайну Microsoft Project:
- Основной синий: #0078D4
- Зелёный успеха: #107C10
- Красный предупреждения: #FF4B4B
- Серый фона: #F3F2F1
- Угольный текст: #323130

## Образец данных

Образец файла проекта (`sample_project.xml`) включён для тестирования. Он демонстрирует:
- 5 ресурсов с различной рабочей нагрузкой
- 8 задач с разной длительностью
- Назначения ресурсов, показывающие сценарии перегрузки и недоиспользования

## Технические детали

- Построен на Streamlit для интерактивного веб-интерфейса
- Использует lxml для надёжного парсинга XML
- Plotly для интерактивных визуализаций
- ReportLab для генерации PDF
- Pandas для обработки данных

## Поддержка

При проблемах с:
- **Парсингом файлов**: Убедитесь, что ваш XML-файл правильно отформатирован как экспорт MS Project
- **Расчётами дат**: Проверьте, что задачи имеют корректные даты начала и окончания
- **Отсутствующими ресурсами**: Проверьте, что ресурсы правильно назначены в исходном проекте
